/* eslint-disable @typescript-eslint/no-unused-expressions */
import "mocha";
import { expect } from "chai";
import { Pigs2Game } from '../../src/games';

describe("Robo Battle Pigs (Continuous Feedback)", () => {
    it("Collisions", () => {
        const g = new Pigs2Game(2);

        // head on
        g.board.clear();
        g.board.set("d4", [1,"N"]);
        g.board.set("d5", [2,"S"]);
        g.move("^,^");
        let orig = g.board.get("d4");
        let after = g.board.get("d5");
        expect(orig).to.not.be.undefined;
        expect(after).to.not.be.undefined;
        expect(orig![0]).eq(1);
        expect(after![0]).eq(2);

        // from angle
        g.board.clear();
        g.board.set("e4", [1,"N"]);
        g.board.set("d5", [2,"S"]);
        g.move("\\,\\");
        orig = g.board.get("e4");
        after = g.board.get("d5");
        expect(orig).to.not.be.undefined;
        expect(after).to.not.be.undefined;
        expect(orig![0]).eq(1);
        expect(after![0]).eq(2);

        g.board.clear();
        g.board.set("e4", [1,"W"]);
        g.board.set("d3", [2,"N"]);
        g.move("^,^");
        orig = g.board.get("e4");
        after = g.board.get("d3");
        expect(orig).to.not.be.undefined;
        expect(after).to.not.be.undefined;
        expect(orig![0]).eq(1);
        expect(after![0]).eq(2);

        // from behind
        g.board.clear();
        g.board.clear();
        g.board.set("d4", [2,"S"]);
        g.board.set("d5", [1,"N"]);
        g.move("v,v");
        orig = g.board.get("d4");
        after = g.board.get("d5");
        expect(orig).to.not.be.undefined;
        expect(after).to.not.be.undefined;
        expect(orig![0]).eq(2);
        expect(after![0]).eq(1);

        // one stationary
        g.board.clear();
        g.board.set("d4", [1,"N"]);
        g.board.set("d5", [2,"S"]);
        g.move(">,^");
        orig = g.board.get("d4");
        after = g.board.get("d5");
        expect(orig).to.not.be.undefined;
        expect(after).to.not.be.undefined;
        expect(orig![0]).eq(1);
        expect(after![0]).eq(2);

        // but crossing is ok
        g.board.clear();
        g.board.set("d4", [1,"N"]);
        g.board.set("e4", [2,"N"]);
        g.move("/,\\");
        orig = g.board.get("d4");
        after = g.board.get("e4");
        expect(orig).to.be.undefined;
        expect(after).to.be.undefined;
        expect(g.board.get("e5")![0]).eq(1);
        expect(g.board.get("d5")![0]).eq(2);

        // as is moving into a vacated space
        g.board.clear();
        g.board.set("d4", [1,"N"]);
        g.board.set("d3", [2,"N"]);
        g.move("^,^");
        const rear = g.board.get("d3");
        const mid = g.board.get("d4");
        const fore = g.board.get("d5");
        expect(rear).to.be.undefined;
        expect(mid).to.not.be.undefined;
        expect(fore).to.not.be.undefined;
        expect(mid![0]).eq(2);
        expect(fore![0]).eq(1);
    });
    it("Bug fix - moving on top of a disabled pig", () => {
        const state = `{"game":"pigs2","numplayers":4,"variants":[],"gameover":false,"withdrawn":[],"winner":[],"stack":[{"_version":"20241216","_results":[],"_timestamp":"2025-09-17T03:14:53.638Z","lastmove":[],"orders":[[],[],[],[]],"damage":[0,0,0,0],"board":{"dataType":"Map","value":[["e1",[1,"N"]],["d8",[2,"S"]],["h5",[3,"W"]],["a4",[4,"E"]]]}},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"move","from":"e1","to":"d2"}]},{"type":"_group","who":2,"results":[{"type":"move","from":"d8","to":"c7"}]},{"type":"_group","who":3,"results":[{"type":"fire","from":"h5","which":"F","to":"a5"}]},{"type":"_group","who":4,"results":[{"type":"move","from":"a4","to":"b4"}]}],"_timestamp":"2025-09-17T04:17:39.904Z","lastmove":["\\\\","/","F","^"],"board":{"dataType":"Map","value":[["d2",[1,"N"]],["c7",[2,"S"]],["h5",[3,"W"]],["b4",[4,"E"]]]},"damage":[0,0,0,0],"orders":[["f","f"],["f","f"],["f","\\\\"],["f","^"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"fire","from":"d2","which":"F","to":"d8"}]},{"type":"_group","who":2,"results":[{"type":"fire","from":"c7","which":"F","to":"c4"},{"type":"damage","who":"4","where":"c4","amount":1}]},{"type":"_group","who":3,"results":[{"type":"move","from":"h5","to":"g4"}]},{"type":"_group","who":4,"results":[{"type":"move","from":"b4","to":"c4"}]}],"_timestamp":"2025-09-18T00:20:33.637Z","lastmove":["F","F","\\\\","^"],"board":{"dataType":"Map","value":[["d2",[1,"N"]],["c7",[2,"S"]],["g4",[3,"W"]],["c4",[4,"E"]]]},"damage":[0,0,0,1],"orders":[["/","f"],["f","f"],["/","f"],[">",">","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"fire","from":"d2","which":"F","to":"d8"}]},{"type":"_group","who":2,"results":[{"type":"fire","from":"c7","which":"F","to":"c4"},{"type":"damage","who":"4","where":"c4","amount":1}]},{"type":"_group","who":3,"results":[{"type":"fire","from":"g4","which":"F","to":"c4"},{"type":"damage","who":"4","where":"c4","amount":1}]},{"type":"_group","who":4,"results":[{"type":"fire","from":"c4","which":"F","to":"g4"},{"type":"damage","who":"3","where":"g4","amount":1}]}],"_timestamp":"2025-09-18T02:05:10.184Z","lastmove":["F","F","F","F"],"board":{"dataType":"Map","value":[["d2",[1,"N"]],["c7",[2,"S"]],["g4",[3,"W"]],["c4",[4,"E"]]]},"damage":[0,0,1,3],"orders":[["\\\\","/"],["f","f"],["f","f","/"],["f","f",">",">"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"move","from":"d2","to":"e3"}]},{"type":"_group","who":2,"results":[{"type":"fire","from":"c7","which":"F","to":"c4"},{"type":"damage","who":"4","where":"c4","amount":1}]},{"type":"_group","who":3,"results":[{"type":"move","from":"g4","to":"f5"}]},{"type":"_group","who":4,"results":[{"type":"orient","where":"c4","facing":"S","what":"cw"}]}],"_timestamp":"2025-09-19T02:01:51.218Z","lastmove":["/","F","/",">"],"board":{"dataType":"Map","value":[["e3",[1,"N"]],["c7",[2,"S"]],["f5",[3,"W"]],["c4",[4,"S"]]]},"damage":[0,0,1,4],"orders":[["f","\\\\"],["/","f"],["f","f","f"],["\\\\","\\\\","f","f",">"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"move","from":"e3","to":"d4"}]},{"type":"_group","who":2,"results":[{"type":"fire","from":"c7","which":"F","to":"c4"},{"type":"damage","who":"4","where":"c4","amount":1}]},{"type":"_group","who":3,"results":[{"type":"fire","from":"f5","which":"F","to":"a5"}]},{"type":"_group","who":4,"results":[{"type":"orient","where":"c4","facing":"W","what":"cw"},{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-19T06:43:36.459Z","lastmove":["\\\\","F","F",">"],"board":{"dataType":"Map","value":[["d4",[1,"N"]],["c7",[2,"S"]],["f5",[3,"W"]],["c4",[4,"U"]]]},"damage":[0,0,1,5],"orders":[["v","f"],["v","/"],["<","f","f"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"fire","from":"d4","which":"F","to":"d8"}]},{"type":"_group","who":2,"results":[{"type":"move","from":"c7","to":"b6"}]},{"type":"_group","who":3,"results":[{"type":"fire","from":"f5","which":"F","to":"a5"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-19T19:03:16.104Z","lastmove":["F","/","F",""],"board":{"dataType":"Map","value":[["d4",[1,"N"]],["b6",[2,"S"]],["f5",[3,"W"]],["c4",[4,"U"]]]},"damage":[0,0,1,5],"orders":[["f","v"],["<","v"],["\\\\","<","f"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"move","from":"d4","to":"d3"}]},{"type":"_group","who":2,"results":[{"type":"move","from":"b6","to":"b7"}]},{"type":"_group","who":3,"results":[{"type":"fire","from":"f5","which":"F","to":"a5"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-19T23:30:01.167Z","lastmove":["v","v","F",""],"board":{"dataType":"Map","value":[["d3",[1,"N"]],["b7",[2,"S"]],["f5",[3,"W"]],["c4",[4,"U"]]]},"damage":[0,0,1,5],"orders":[["v","f"],["h","<"],["/","\\\\","<"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"fire","from":"d3","which":"F","to":"d8"}]},{"type":"_group","who":2,"results":[{"type":"orient","where":"b7","facing":"E","what":"ccw"}]},{"type":"_group","who":3,"results":[{"type":"orient","where":"f5","facing":"S","what":"ccw"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-20T05:44:04.703Z","lastmove":["F","<","<",""],"board":{"dataType":"Map","value":[["d3",[1,"N"]],["b7",[2,"E"]],["f5",[3,"S"]],["c4",[4,"U"]]]},"damage":[0,0,1,5],"orders":[["/","v"],["f","h"],[">","/","\\\\"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"move","from":"d3","to":"d2"}]},{"type":"_group","who":2,"results":[{"type":"fire","which":"H"}]},{"type":"_group","who":3,"results":[{"type":"move","from":"f5","to":"g4"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-20T18:12:51.951Z","lastmove":["v","H","\\\\",""],"board":{"dataType":"Map","value":[["d2",[1,"N"]],["b7",[2,"E"]],["g4",[3,"S"]],["c4",[4,"U"]]]},"damage":[0,0,1,5],"orders":[["f","/"],[">","f"],["f",">","/"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"move","from":"d2","to":"e3"}]},{"type":"_group","who":2,"results":[{"type":"fire","from":"b7","which":"F","to":"h7"}]},{"type":"_group","who":3,"results":[{"type":"move","from":"g4","to":"f3"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-21T16:29:16.456Z","lastmove":["/","F","/",""],"board":{"dataType":"Map","value":[["e3",[1,"N"]],["b7",[2,"E"]],["f3",[3,"S"]],["c4",[4,"U"]]]},"damage":[0,0,1,5],"orders":[[">","f"],["\\\\",">"],["\\\\","f",">"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"fire","from":"e3","which":"F","to":"e8"}]},{"type":"_group","who":2,"results":[{"type":"orient","where":"b7","facing":"S","what":"cw"}]},{"type":"_group","who":3,"results":[{"type":"orient","where":"f3","facing":"W","what":"cw"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-22T03:20:36.685Z","lastmove":["F",">",">",""],"board":{"dataType":"Map","value":[["e3",[1,"N"]],["b7",[2,"S"]],["f3",[3,"W"]],["c4",[4,"U"]]]},"damage":[0,0,1,5],"orders":[["h",">"],["h","\\\\"],[">","\\\\","f"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"orient","where":"e3","facing":"E","what":"cw"}]},{"type":"_group","who":2,"results":[{"type":"move","from":"b7","to":"c6"}]},{"type":"_group","who":3,"results":[{"type":"fire","from":"f3","which":"F","to":"e3"},{"type":"damage","who":"1","where":"e3","amount":1}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-23T00:21:28.403Z","lastmove":[">","\\\\","F",""],"board":{"dataType":"Map","value":[["e3",[1,"E"]],["c6",[2,"S"]],["f3",[3,"W"]],["c4",[4,"U"]]]},"damage":[1,0,1,5],"orders":[["f","f","h"],["^","h"],["f",">","\\\\"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"fire","which":"H"}]},{"type":"_group","who":2,"results":[{"type":"fire","which":"H"}]},{"type":"_group","who":3,"results":[{"type":"move","from":"f3","to":"e2"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-23T02:08:31.142Z","lastmove":["H","H","\\\\",""],"board":{"dataType":"Map","value":[["e3",[1,"E"]],["c6",[2,"S"]],["e2",[3,"W"]],["c4",[4,"U"]]]},"damage":[1,0,1,5],"orders":[["f","f","f"],["\\\\","^"],["h","f",">"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"fire","from":"e3","which":"F","to":"h3"}]},{"type":"_group","who":2,"results":[{"type":"move","from":"c6","to":"c5"}]},{"type":"_group","who":3,"results":[{"type":"orient","where":"e2","facing":"N","what":"cw"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-24T02:28:07.243Z","lastmove":["F","^",">",""],"board":{"dataType":"Map","value":[["e3",[1,"E"]],["c5",[2,"S"]],["e2",[3,"N"]],["c4",[4,"U"]]]},"damage":[1,0,1,5],"orders":[["\\\\","f","f"],["h","\\\\"],["h","h","f"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"fire","from":"e3","which":"F","to":"h3"}]},{"type":"_group","who":2,"results":[{"type":"move","from":"c5","to":"d4"}]},{"type":"_group","who":3,"results":[{"type":"fire","from":"e2","which":"F","to":"e3"},{"type":"damage","who":"1","where":"e3","amount":1}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-24T13:22:50.552Z","lastmove":["F","\\\\","F",""],"board":{"dataType":"Map","value":[["e3",[1,"E"]],["d4",[2,"S"]],["e2",[3,"N"]],["c4",[4,"U"]]]},"damage":[2,0,1,5],"orders":[["v","v","\\\\","f"],["h","h"],["\\\\","h","h"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"fire","from":"e3","which":"F","to":"h3"}]},{"type":"_group","who":2,"results":[{"type":"fire","which":"H"},{"type":"damage","who":"1","where":"e3","amount":1}]},{"type":"_group","who":3,"results":[{"type":"fire","which":"H"},{"type":"damage","who":"1","where":"e3","amount":1}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-25T00:30:49.345Z","lastmove":["F","H","H",""],"board":{"dataType":"Map","value":[["e3",[1,"E"]],["d4",[2,"S"]],["e2",[3,"N"]],["c4",[4,"U"]]]},"damage":[4,0,1,5],"orders":[["v","v","v","v","\\\\"],["\\\\","h"],["h","\\\\","h"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"move","from":"e3","to":"f4"}]},{"type":"_group","who":2,"results":[{"type":"fire","which":"H"}]},{"type":"_group","who":3,"results":[{"type":"fire","which":"H"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-25T04:05:33.855Z","lastmove":["\\\\","H","H",""],"board":{"dataType":"Map","value":[["f4",[1,"E"]],["d4",[2,"S"]],["e2",[3,"N"]],["c4",[4,"U"]]]},"damage":[4,0,1,5],"orders":[["h","v","v","v","v"],["h","\\\\"],["f","h","\\\\"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"move","from":"f4","to":"e4"}]},{"type":"_group","who":2,"results":[{"type":"move","from":"d4","to":"e3"}]},{"type":"_group","who":3,"results":[{"type":"move","from":"e2","to":"d3"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-25T23:29:11.545Z","lastmove":["v","\\\\","\\\\",""],"board":{"dataType":"Map","value":[["e4",[1,"E"]],["e3",[2,"S"]],["d3",[3,"N"]],["c4",[4,"U"]]]},"damage":[4,0,1,5],"orders":[["<","h","v","v","v"],["<","h"],[">","f","h"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"move","from":"e4","to":"d4"},{"type":"eliminated","who":"1"}]},{"type":"_group","who":2,"results":[{"type":"fire","which":"H"}]},{"type":"_group","who":3,"results":[{"type":"fire","which":"H"},{"type":"damage","who":"4","where":"c4","amount":0},{"type":"damage","who":"1","where":"d4","amount":1}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-26T04:26:40.544Z","lastmove":["v","H","H",""],"board":{"dataType":"Map","value":[["d4",[1,"U"]],["e3",[2,"S"]],["d3",[3,"N"]],["c4",[4,"U"]]]},"damage":[5,0,1,5],"orders":[["h","h","<","h","v","v"],["/","<"],["h",">","f"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"eliminated","who":"1"}]},{"type":"_group","who":2,"results":[{"type":"orient","where":"e3","facing":"E","what":"ccw"}]},{"type":"_group","who":3,"results":[{"type":"fire","from":"d3","which":"F","to":"d4"},{"type":"damage","who":"1","where":"d4","amount":0}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-26T13:23:36.093Z","lastmove":["","<","F",""],"board":{"dataType":"Map","value":[["d4",[1,"U"]],["e3",[2,"E"]],["d3",[3,"N"]],["c4",[4,"U"]]]},"damage":[5,0,1,5],"orders":[["h","h","<","h","v","v"],["<","/"],["f","h",">"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"eliminated","who":"1"}]},{"type":"_group","who":2,"results":[{"type":"move","from":"e3","to":"f2"}]},{"type":"_group","who":3,"results":[{"type":"orient","where":"d3","facing":"E","what":"cw"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-26T14:14:19.565Z","lastmove":["","/",">",""],"board":{"dataType":"Map","value":[["d4",[1,"U"]],["f2",[2,"E"]],["d3",[3,"E"]],["c4",[4,"U"]]]},"damage":[5,0,1,5],"orders":[["h","h","<","h","v","v"],["h","<"],["h","f","h"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"eliminated","who":"1"}]},{"type":"_group","who":2,"results":[{"type":"orient","where":"f2","facing":"N","what":"ccw"}]},{"type":"_group","who":3,"results":[{"type":"fire","which":"H"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-26T19:47:46.577Z","lastmove":["","<","H",""],"board":{"dataType":"Map","value":[["d4",[1,"U"]],["f2",[2,"N"]],["d3",[3,"E"]],["c4",[4,"U"]]]},"damage":[5,0,1,5],"orders":[["h","h","<","h","v","v"],["h","h"],["/","h","f"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"eliminated","who":"1"}]},{"type":"_group","who":2,"results":[{"type":"fire","which":"H"}]},{"type":"_group","who":3,"results":[{"type":"fire","from":"d3","which":"F","to":"h3"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-26T22:06:58.319Z","lastmove":["","H","F",""],"board":{"dataType":"Map","value":[["d4",[1,"U"]],["f2",[2,"N"]],["d3",[3,"E"]],["c4",[4,"U"]]]},"damage":[5,0,1,5],"orders":[["h","h","<","h","v","v"],["<","h"],["f","/","h"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"eliminated","who":"1"}]},{"type":"_group","who":2,"results":[{"type":"fire","which":"H"}]},{"type":"_group","who":3,"results":[{"type":"fire","which":"H"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-27T03:48:52.920Z","lastmove":["","H","H",""],"board":{"dataType":"Map","value":[["d4",[1,"U"]],["f2",[2,"N"]],["d3",[3,"E"]],["c4",[4,"U"]]]},"damage":[5,0,1,5],"orders":[["h","h","<","h","v","v"],["/","<"],["v","f","/"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"eliminated","who":"1"}]},{"type":"_group","who":2,"results":[{"type":"orient","where":"f2","facing":"W","what":"ccw"}]},{"type":"_group","who":3,"results":[{"type":"move","from":"d3","to":"e2"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-27T03:52:16.373Z","lastmove":["","<","/",""],"board":{"dataType":"Map","value":[["d4",[1,"U"]],["f2",[2,"W"]],["e2",[3,"E"]],["c4",[4,"U"]]]},"damage":[5,0,1,5],"orders":[["h","h","<","h","v","v"],["h","/"],["f","v","f"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"eliminated","who":"1"}]},{"type":"_group","who":2,"results":[{"type":"move","from":"f2","to":"e3"}]},{"type":"_group","who":3,"results":[{"type":"fire","from":"e2","which":"F","to":"h2"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-27T17:51:09.131Z","lastmove":["","/","F",""],"board":{"dataType":"Map","value":[["d4",[1,"U"]],["e3",[2,"W"]],["e2",[3,"E"]],["c4",[4,"U"]]]},"damage":[5,0,1,5],"orders":[["h","h","<","h","v","v"],["<","h"],["h","f","v"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"eliminated","who":"1"}]},{"type":"_group","who":2,"results":[{"type":"fire","which":"H"},{"type":"damage","who":"1","where":"d4","amount":0},{"type":"damage","who":"3","where":"d2","amount":1}]},{"type":"_group","who":3,"results":[{"type":"move","from":"e2","to":"d2"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-27T17:56:18.095Z","lastmove":["","H","v",""],"board":{"dataType":"Map","value":[["d4",[1,"U"]],["e3",[2,"W"]],["d2",[3,"E"]],["c4",[4,"U"]]]},"damage":[5,0,2,5],"orders":[["h","h","<","h","v","v"],["h","<"],["v","v","h","f"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"eliminated","who":"1"}]},{"type":"_group","who":2,"results":[{"type":"orient","where":"e3","facing":"S","what":"ccw"}]},{"type":"_group","who":3,"results":[{"type":"fire","from":"d2","which":"F","to":"h2"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-27T22:01:48.722Z","lastmove":["","<","F",""],"board":{"dataType":"Map","value":[["d4",[1,"U"]],["e3",[2,"S"]],["d2",[3,"E"]],["c4",[4,"U"]]]},"damage":[5,0,2,5],"orders":[["h","h","<","h","v","v"],["v","h"],["f","v","v","h"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"eliminated","who":"1"}]},{"type":"_group","who":2,"results":[{"type":"fire","which":"H"},{"type":"damage","who":"3","where":"d2","amount":1}]},{"type":"_group","who":3,"results":[{"type":"fire","which":"H"},{"type":"damage","who":"2","where":"e3","amount":1}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-27T22:43:31.201Z","lastmove":["","H","H",""],"board":{"dataType":"Map","value":[["d4",[1,"U"]],["e3",[2,"S"]],["d2",[3,"E"]],["c4",[4,"U"]]]},"damage":[5,1,3,5],"orders":[["h","h","<","h","v","v"],["h","h","v"],["\\\\","\\\\","f","v","v"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"eliminated","who":"1"}]},{"type":"_group","who":2,"results":[{"type":"move","from":"e3","to":"e4"}]},{"type":"_group","who":3,"results":[{"type":"move","from":"d2","to":"c2"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-28T00:54:03.549Z","lastmove":["","v","v",""],"board":{"dataType":"Map","value":[["d4",[1,"U"]],["e4",[2,"S"]],["c2",[3,"E"]],["c4",[4,"U"]]]},"damage":[5,1,3,5],"orders":[["h","h","<","h","v","v"],["/","h","h"],["f","\\\\","\\\\","f","v"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"eliminated","who":"1"}]},{"type":"_group","who":2,"results":[{"type":"fire","which":"H"}]},{"type":"_group","who":3,"results":[{"type":"move","from":"c2","to":"b2"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-28T01:59:19.553Z","lastmove":["","H","v",""],"board":{"dataType":"Map","value":[["d4",[1,"U"]],["e4",[2,"S"]],["b2",[3,"E"]],["c4",[4,"U"]]]},"damage":[5,1,3,5],"orders":[["h","h","<","h","v","v"],["h","/","h"],["v","f","\\\\","\\\\","f"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"eliminated","who":"1"}]},{"type":"_group","who":2,"results":[{"type":"fire","which":"H"}]},{"type":"_group","who":3,"results":[{"type":"fire","from":"b2","which":"F","to":"h2"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-28T17:01:14.906Z","lastmove":["","H","F",""],"board":{"dataType":"Map","value":[["d4",[1,"U"]],["e4",[2,"S"]],["b2",[3,"E"]],["c4",[4,"U"]]]},"damage":[5,1,3,5],"orders":[["h","h","<","h","v","v"],[">","h","/"],["<","v","f","\\\\","\\\\"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"eliminated","who":"1"}]},{"type":"_group","who":2,"results":[{"type":"move","from":"e4","to":"d3"}]},{"type":"_group","who":3,"results":[{"type":"move","from":"b2","to":"c3"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-28T17:06:38.963Z","lastmove":["","/","\\\\",""],"board":{"dataType":"Map","value":[["d4",[1,"U"]],["d3",[2,"S"]],["c3",[3,"E"]],["c4",[4,"U"]]]},"damage":[5,1,3,5],"orders":[["h","h","<","h","v","v"],["h",">","h"],["^","<","v","f","\\\\"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"eliminated","who":"1"}]},{"type":"_group","who":2,"results":[{"type":"fire","which":"H"}]},{"type":"_group","who":3,"results":[{"type":"move","from":"c3","to":"d4"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-28T17:07:53.107Z","lastmove":["","H","\\\\",""],"board":{"dataType":"Map","value":[["d4",[3,"E"]],["d3",[2,"S"]],["c4",[4,"U"]]]},"damage":[5,1,3,5],"orders":[["h","h","<","h","v","v"],["h","h",">"],["^","^","<","v","f"],["h","h","\\\\","\\\\","f","f"]]},{"_version":"20241216","_results":[{"type":"_group","who":1,"results":[{"type":"eliminated","who":"1"}]},{"type":"_group","who":2,"results":[{"type":"orient","where":"d3","facing":"W","what":"cw"}]},{"type":"_group","who":3,"results":[{"type":"fire","from":"d4","which":"F","to":"h4"}]},{"type":"_group","who":4,"results":[{"type":"eliminated","who":"4"}]}],"_timestamp":"2025-09-28T17:11:56.405Z","lastmove":["",">","F",""],"board":{"dataType":"Map","value":[["d3",[2,"W"]],["d4",[3,"E"]],["c4",[4,"U"]]]},"damage":[5,1,3,5],"orders":[["h","h","<","h","v","v"],["\\\\","h","h"],[">","^","^","<","v"],["h","h","\\\\","\\\\","f","f"]]}]}`;
        const g = new Pigs2Game(state);
        expect(g.board.size).eq(3);
        g.move("\u0091,H,v,\u0091");
        expect(g.board.size).eq(2);
        const pc = g.board.get("c4");
        expect(pc).to.not.be.undefined;
        expect(pc![0]).eq(3);
        expect(pc![1]).eq("E");
    });
});

